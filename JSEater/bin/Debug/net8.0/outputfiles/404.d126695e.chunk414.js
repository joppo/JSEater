"use strict";(self.webpackChunkresearcher_portal=self.webpackChunkresearcher_portal||[]).push([[404,581],{56404:function(e,i,n){n.r(i),n.d(i,{ConversationTimelineItem:function(){return w}});var s=n(74165),t=n(29439),o=n(29388),a=n(80184),r=n(72791),l=n(28627),d=n(42089),c=n(96123),u=n(27631),g=n(77291),p=n(54794),m=n(42053),v=n(73413),h=n(77726),b=n(40596),x=function(e){var i=e.author,n=void 0===i?{}:i,s=e.date,t=e.id,o=e.isMe,r=void 0!==o&&o,d=e.isLoadingMarkAsRead,c=e.isLoadingMarkAsUnread,u=e.isDataLoaded,g=void 0!==u&&u,p=e.isFlagged,x=e.isRead,f=e.message,j=e.onClickFlagMessage,y=e.onMarkUnread,k=e.onMarkRead,M=(0,h.p)(),w=(0,b.b)({author:n,isDataLoaded:g});return(0,a.jsx)(l.l,{reversed:r,activityDescription:(0,a.jsx)(v.M,Object.assign({},{author:n,date:s,isDataLoaded:g,message:f,onClickFlagMessage:j,onMarkUnread:y,isLoadingMarkAsRead:d,isLoadingMarkAsUnread:c,onMarkRead:k,isFlagged:p,isRead:x,id:t},{isReplyMessage:!0})),activityPersonas:[Object.assign(Object.assign({},w),{coinSize:32})],styles:(0,m.T)({},M,Object.assign({root:Object.assign({selectors:{".ms-Persona-initials":{fontSize:12}}},p&&{padding:"0 0 0 16px"})},p&&{activityContent:{}}))})},f=n(33581),j=n(57717),y=n(40434),k=n(763),M=n(60461),w=function(e){var i,n,m=e.errorMessageOnReply,w=e.id,R=e.isDataLoaded,C=e.isFlagged,O=e.isRefreshInProgress,S=e.isLoadingMarkAsRead,L=e.isLoadingMarkAsUnread,I=e.isSubscribed,A=e.onClickFlagMessage,F=e.onClickSetSubscribe,P=e.onClickLoadMore,U=e.onClickUnflagAll,q=e.onMarkRead,B=e.onMarkUnread,D=e.onReply,V=e.replyMessages,N=void 0===V?[]:V,T=e.isLoadingOnReply,Z=e.isOpenByDefault,z=void 0!==Z&&Z,E=e.firstMessage,_=e.topic,K=E||{},W=K.author,H=K.message,G=K.isRead,Q=(0,h.p)(),J=(0,b.b)({author:W,isDataLoaded:R}),Y=(0,y.BV)().theme,X=(0,j.k)(!0),$=(0,t.Z)(X,2),ee=$[0],ie=$[1].toggle,ne=(0,r.useState)(z),se=(0,t.Z)(ne,2),te=se[0],oe=se[1],ae=(0,r.useState)(T),re=(0,t.Z)(ae,2),le=re[0],de=re[1],ce=null===(i=null===N||void 0===N?void 0:N[0])||void 0===i?void 0:i.id;(0,r.useEffect)((function(){de(!1)}),[ce,de]);var ue="1px solid ".concat(null===Y||void 0===Y?void 0:Y.palette.neutralQuaternaryAlt),ge=N.length>0||T,pe=(0,k.compact)([A&&(null===E||void 0===E?void 0:E.id)&&{key:"flag-message-item",iconProps:{iconName:"IconSetsFlag"},onClick:function(){(null===E||void 0===E?void 0:E.id)&&A(E.id,!C)},text:(null===E||void 0===E?void 0:E.isFlagged)?"Unflag only this message":"Flag only this message"},U&&w&&C&&{key:"unflag all",iconProps:{iconName:"IconSetsFlag"},text:"Unflag all messages in this conversation",onClick:function(){return U({conversationId:w})},checked:C},F&&w&&{key:"subscribe unsubscribe",iconProps:{iconName:I?"Hide3":"View"},onClick:function(){return F(w,!I)},text:I?"Unsubscribe from this conversation":"Subscribe to this conversation",checked:I}]),me=_?null===(n=M.ZL[_])||void 0===n?void 0:n.displayName:void 0;return(0,a.jsx)(l.l,{activityDescription:(0,a.jsxs)("div",Object.assign({style:{backgroundColor:null===Y||void 0===Y?void 0:Y.palette.white,border:ue,borderRadius:"3px"}},{children:[(0,a.jsx)(v.M,Object.assign({topicList:me?[me]:void 0},{additionalDropdownMenuItems:pe,date:null===E||void 0===E?void 0:E.date,id:null===E||void 0===E?void 0:E.id,isDataLoaded:R,isFlagged:C,isLoadingMarkAsUnread:L,isLoadingMarkAsRead:S,isRead:G,message:H,onMarkUnread:B,onMarkRead:q,author:null===E||void 0===E?void 0:E.author})),(0,a.jsxs)("div",Object.assign({style:{background:null===Y||void 0===Y?void 0:Y.palette.neutralLighterAlt,borderRadius:"0 0 3px 3px",borderTop:ue}},{children:[ge&&(0,a.jsxs)("details",Object.assign({open:ee},{children:[(0,a.jsx)("summary",Object.assign({onClick:function(e){e.preventDefault(),ie()},style:{borderBottom:ue,color:null===Y||void 0===Y?void 0:Y.palette.themePrimary,cursor:"pointer",padding:2}},{children:ee?"Collapse all":"Show all replies"})),P&&(0,a.jsx)("div",Object.assign({style:{margin:"1rem 0",paddingLeft:65}},{children:(0,a.jsx)(d.r,Object.assign({onClick:P},{children:"Load prior replies"}))})),(0,a.jsxs)("div",Object.assign({style:{borderBottom:ue}},{children:[null===N||void 0===N?void 0:N.map((function(e,i){return(0,a.jsx)(x,Object.assign({},e,{onClickFlagMessage:A,onMarkUnread:B,isLoadingMarkAsRead:S,isLoadingMarkAsUnread:L,onMarkRead:q}),i)})),(le||T)&&(0,a.jsx)(x,{isDataLoaded:!1}),O&&(0,a.jsx)(c.q,{})]}))]})),(0,a.jsxs)("div",Object.assign({style:{display:te?"block":"none"}},{children:[(0,a.jsx)(u.c,Object.assign({messageBarType:g.f.info},{children:"Conversations are going away soon. They will be replaced by a flat timeline of messages. Existing conversations will continue to be displayed for now, but you will not be able to create new conversations."})),(0,a.jsx)(f.TimelineMessageForm,{id:w,onCancel:function(){oe(!1)},onSubmit:function(e){return(0,o.__awaiter)(void 0,void 0,void 0,(0,s.Z)().mark((function i(){var n;return(0,s.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return de(!0),i.next=3,D(e);case 3:return(n=i.sent).success&&oe(!1),setTimeout((function(){de(!1)}),2e3),i.abrupt("return",n);case 7:case"end":return i.stop()}}),i)})))},isLoading:T,submittingMessage:"Sending reply",errorMessage:m})]})),!te&&(0,a.jsx)(p.K,Object.assign({iconProps:{iconName:"Reply"},onClick:function(){return oe(!0)},styles:{root:{fontSize:"12px",width:"100%"}}},{children:"Reply"}))]}))]})),activityPersonas:[J],styles:Q})}},30910:function(e,i,n){n.d(i,{w:function(){return l}});var s=n(80184),t=n(4026),o=n(88456),a=n(77291),r=n(40434),l=function(e){var i=e.children,n=e.isBold,l=e.isBlock,d=void 0!==l&&l,c=function(e){var i=(0,r.BV)().theme;switch(e){case a.f.error:return null===i||void 0===i?void 0:i.palette.red;case a.f.success:default:return}}(e.messageType);return(0,s.jsx)(t.x,Object.assign({styles:{root:{color:c,fontWeight:o.lq[n?"bold":""]}},block:d,variant:"small"},{children:i}))}},73413:function(e,i,n){n.d(i,{M:function(){return V}});var s=n(29439),t=n(80184),o=n(72791),a=n(6975),r=n(33084),l=n(88456),d=n(96123),c=n(63266),u=n(4026),g=n(71210),p=n(30910),m=n(40434),v=n(39520),h=n(23441),b=n(34940),x=n(763),f=b.s.gap,j=b.s.line,y=[{height:14,type:j,width:141},{type:f,width:16},{height:14,type:j,width:93},{type:f,width:"calc(100% - 250px)"}],k=[{type:j,width:"95%"},{height:20,type:f,width:"5%"},{type:j,width:"90%"},{height:20,type:f,width:"10%"},{type:j,width:"70%"},{height:20,type:f,width:"30%"}],M=(0,x.concat)(y,k),w=n(42089),R=n(43310),C=function(e){var i=e.isRead,n=e.message,a=(0,m.BV)().theme,r=305,d=n&&n.length>r,c=(0,o.useState)(i&&d),u=(0,s.Z)(c,2),g=u[0],p=u[1],v=null===n||void 0===n?void 0:n.indexOf("\n",r),h=v&&v>0&&v<=457.5?v:r,b="".concat(null===n||void 0===n?void 0:n.substring(0,h)," &hellip;");return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",Object.assign({style:{position:"relative"}},{children:[(0,t.jsx)(R.d,{text:g?b:n}),g&&d&&(0,t.jsx)("div",{className:(0,l.y0)({content:"",position:"absolute",zIndex:5,bottom:0,left:0,width:"100%",height:"0.9em",backgroundImage:"linear-gradient(to bottom, \n                    ".concat((0,m.bu)(a.palette.neutralLighterAlt,"0.00"),", \n                    ").concat((0,m.bu)(a.palette.neutralLighterAlt,"0.90")," 75%);")})})]})),d&&(0,t.jsx)(w.r,Object.assign({onClick:function(){return p((function(e){return!e}))},underline:!0},{children:g?"See more":"See less"}))]})},O=n(93433),S=n(59332),L=n(18511),I=n(29093),A=n(81080),F=function(e,i){return e?"Flag is loading":i?"Unflag this message":"Flag this message"},P=function(e){var i,n,s=e.isFlagged,o=void 0!==s&&s,a=e.id,r=e.onClickFlagMessage,l=e.onMarkUnread,d=e.isResponseRequired,c=e.onSetResponseRequire,u=e.additionalDropdownMenuItems,g=e.isFlagAnimating,p=void 0!==g&&g,v=e.setIsFlagAnimating,h=e.isLoadingMarkAsUnread,b=e.setIsMarkedAsUnreadByUser,f=e.isRequireResponseValue,j=e.setIsRequireResponseValue,y=(0,m.BV)().theme;return(0,t.jsxs)(S.K,Object.assign({horizontal:!0,horizontalAlign:"end",verticalAlign:"baseline",tokens:{childrenGap:"4%"}},{children:[d&&(0,t.jsx)(L.J,{iconName:"PencilReply",title:"You requested a response to this message",styles:{root:{color:null===(i=null===y||void 0===y?void 0:y.semanticColors)||void 0===i?void 0:i.infoIcon}}}),o&&(0,t.jsx)(L.J,{iconName:"Flag",title:"You flagged this message for followup",styles:{root:{borderRadius:"100%",boxShadow:null===y||void 0===y?void 0:y.effects.elevation8,color:null===(n=null===y||void 0===y?void 0:y.semanticColors)||void 0===n?void 0:n.warningIcon}}}),a&&(r||l||c||u&&u.length>0)&&(0,t.jsx)(I.h,{ariaLabel:"View message options",iconProps:{iconName:"More"},menuProps:{directionalHint:A.b.bottomRightEdge,items:(0,x.compact)([r&&{key:"flag-message-item",iconProps:{iconName:"IconSetsFlag"},disabled:p,onClick:function(){v(!0),r(a,!o)},text:F(p,o)},l&&{key:"mark-as-unread",iconProps:{iconName:"RedEye"},disabled:h,onClick:function(){b(!0),l({messageIds:[a]})},text:"Mark as unread"},c&&{key:"set require / do not response",iconProps:{iconName:f?"Uneditable2":"PencilReply"},text:f?"Set response not required":"Set response is required",onClick:function(){var e=!f;j(e),c({isResponseRequired:e})}}].concat((0,O.Z)(u||[])))}})]}))},U=n(73570),q=n(81318),B=function(e){var i,n=e.name,s=e.downloadUrl,o=(0,x.compact)([s&&{key:"download",text:"Download",iconProps:{iconName:"Download"},href:s,target:"_blank"},s&&(null===(i=null===navigator||void 0===navigator?void 0:navigator.clipboard)||void 0===i?void 0:i.writeText)&&{key:"copyLink",text:"Copy link",iconProps:{iconName:"Link"},onClick:function(){navigator.clipboard.writeText(s)}}]),a=o.length>0;return(0,t.jsxs)(q.a,Object.assign({menuIconProps:a?{iconName:"More"}:void 0,menuProps:a?{items:o}:void 0},{children:[(0,t.jsx)(L.J,{styles:{root:{fontSize:l.TS.mediumPlus}},iconName:"TextDocument"}),n]}))},D=function(e){var i=e.attachmentList,n=(0,o.useState)(!1),a=(0,s.Z)(n,2),r=a[0],d=a[1],c=(0,m.BV)().theme;return(0,t.jsx)("div",Object.assign({style:{backgroundColor:c.semanticColors.bodyDivider,borderRadius:c.effects.roundedCorner4,padding:"0.5rem"}},{children:(0,t.jsxs)("details",Object.assign({open:r},{children:[(0,t.jsxs)("summary",Object.assign({style:{paddingBottom:"0.5rem"},onClick:function(){return d(!r)}},{children:[(0,t.jsx)(w.r,Object.assign({onClick:function(){return d(!r)}},{children:r?"Hide attachments":"Show attachments"})),(0,t.jsx)(U.Vp,Object.assign({background:c.semanticColors.accentButtonBackground,color:c.semanticColors.accentButtonText},{children:null===i||void 0===i?void 0:i.length}))]})),(0,t.jsx)(S.K,Object.assign({as:"ul",className:l.k4.slideDownIn20,horizontal:!0,wrap:!0,tokens:{childrenGap:8},styles:{root:{listStyleType:"none",paddingInlineStart:"0px"}}},{children:(0,x.map)(i,(function(e,i){return(0,t.jsx)("li",Object.assign({style:{listStyleType:"none",paddingInlineStart:"0px"}},{children:(0,t.jsx)(B,Object.assign({},e))}),"".concat(e.name,"-").concat(i))}))}))]}))}))},V=function(e){var i,n=e.additionalDropdownMenuItems,b=void 0===n?[]:n,f=e.author,j=e.date,y=e.id,k=e.isLoadingMarkAsUnread,w=e.isLoadingMarkAsRead,R=e.isDataLoaded,O=e.isRead,S=void 0===O||O,L=e.isFlagged,I=void 0!==L&&L,A=e.isReplyMessage,F=e.message,q=e.onClickFlagMessage,B=e.onMarkRead,V=e.onMarkUnread,N=e.topicList,T=e.isResponseRequired,Z=e.attachmentList,z=e.onSetResponseRequire,E=(0,m.BV)(),_=E.isDarkMode,K=E.theme,W=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=(0,o.useState)(i),t=(0,s.Z)(n,2),a=t[0],r=t[1],l=(0,o.useState)(!1),d=(0,s.Z)(l,2),c=d[0],u=d[1];return(0,o.useEffect)((function(){e!=a&&(r(a),c&&u(!1))}),[e]),[c,u]}(I),H=(0,s.Z)(W,2),G=H[0],Q=H[1],J=(0,o.useState)(!1),Y=(0,s.Z)(J,2),X=Y[0],$=Y[1],ee=(0,o.useState)(T),ie=(0,s.Z)(ee,2),ne=ie[0],se=ie[1],te=(0,o.useState)(!1),oe=(0,s.Z)(te,2),ae=oe[0],re=oe[1],le=(0,h.YD)({delay:7e3,threshold:.66,rootMargin:"12px",trackVisibility:!0,triggerOnce:!0,initialInView:!1}),de=le.inView,ce=le.ref;return(0,o.useEffect)((function(){X||S||!de||!B||w||ae||!y||(re(!0),B({messageIds:[y]}))}),[y,de,w,X,S,B,ae]),(0,t.jsxs)(a.k,Object.assign({direction:r.U.horizontal,id:y,className:(0,l.y0)(Object.assign(Object.assign(Object.assign(Object.assign({width:"100%",backgroundColor:K.palette.neutralLighterAlt,border:"1px outset ".concat(K.semanticColors.variantBorder),borderRadius:K.effects.roundedCorner6,boxSizing:"border-box"},I&&{backgroundColor:null===K||void 0===K?void 0:K.semanticColors.warningBackground,borderLeft:"4px solid ".concat(null===K||void 0===K?void 0:K.semanticColors.severeWarningIcon)}),!S&&{borderRight:"4px ".concat(null===(i=null===K||void 0===K?void 0:K.palette)||void 0===i?void 0:i.accent," solid")}),!A&&{padding:"1rem 16px 1px"}),A&&{padding:".5rem 16px 1px"}))},{children:[(0,t.jsxs)(d.q,Object.assign({customElementsGroup:(0,t.jsx)(c.N,{flexWrap:!0,shimmerElements:M}),isDataLoaded:R,styles:Object.assign({shimmerWrapper:{marginBottom:"1rem"}},_&&I&&{root:{selectors:{a:{color:"#c7e0f4"}}}})},{children:[(0,t.jsxs)("div",Object.assign({ref:ce,style:{alignItems:"center",display:"flex",justifyContent:"space-between",margin:"-.5em 0 0"}},{children:[(0,t.jsxs)("div",{children:[(null===f||void 0===f?void 0:f.name)&&(0,t.jsx)(p.w,{children:null===f||void 0===f?void 0:f.name}),N&&(0,x.map)(N,(function(e,i){return(0,t.jsx)(U.Vp,{children:e},"".concat(e,"-").concat(i))})),(0,t.jsx)(u.x,Object.assign({styles:{root:{marginLeft:".5rem"}},variant:"xSmall"},{children:(0,v.MZ)(j)}))]}),(0,t.jsx)(P,Object.assign({},{isResponseRequired:T,isFlagged:I,id:y,onClickFlagMessage:q,onMarkUnread:V,onSetResponseRequire:z,additionalDropdownMenuItems:b,isFlagAnimating:G,setIsFlagAnimating:Q,isLoadingMarkAsUnread:k,setIsMarkedAsUnreadByUser:$,isRequireResponseValue:ne,setIsRequireResponseValue:se}))]})),(0,t.jsx)(C,Object.assign({},{isRead:S,message:F}))]})),Z&&Z.length&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.Z,{}),(0,t.jsx)(D,{attachmentList:Z})]})]}),null!==y&&void 0!==y?y:"vuln-report--message--".concat(y))}},33581:function(e,i,n){n.r(i),n.d(i,{TimelineMessageForm:function(){return j}});var s=n(74165),t=n(29439),o=n(29388),a=n(80184),r=n(72791),l=n(61134),d=n(29093),c=n(97086),u=n(35278),g=n(46933),p=n(56487),m=n(59332),v=n(54794),h=n(92165),b=n(1561),x=n(43310),f=n(60461),j=function(e){var i=e.onSubmit,n=e.quickReplyItems,j=e.submittingMessage,y=e.withTopic,k=e.onCancel,M=e.errorMessage,w=e.isLoading,R=e.id,C=(0,l.cI)(),O=C.control,S=C.formState,L=C.getValues,I=C.handleSubmit,A=C.setValue,F=C.watch,P=C.reset,U=(0,r.useState)(""),q=(0,t.Z)(U,2),B=q[0],D=q[1],V=B&&B.length>0,N=F(),T=N.reply,Z=N.topic;return(0,a.jsxs)("form",Object.assign({id:"timeline-message-reply-form-".concat(R||"new"),noValidate:!0,onSubmit:I((function(e){return(0,o.__awaiter)(void 0,void 0,void 0,(0,s.Z)().mark((function n(){var t;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i(e);case 2:(null===(t=n.sent)||void 0===t?void 0:t.success)&&(A("reply",""),A("topic",undefined));case 4:case"end":return n.stop()}}),n)})))})),style:{padding:".5rem 16px 1rem",position:"relative"}},{children:[(0,a.jsx)(d.h,{onClick:function(){P(),k()},iconProps:{iconName:"Cancel"},styles:{root:{position:"absolute",right:"16px",top:"16px",zIndex:1}},title:"Cancel message"}),y&&(0,a.jsx)(l.Qr,{control:O,defaultValue:Z,name:"topic",render:function(){var e;return(0,a.jsx)(c.L,{errorMessage:null===(e=S.errors.topic)||void 0===e?void 0:e.message,label:"Topic",onChange:function(e,i){i&&f.Iz[i.key]&&A("topic",f.Iz[i.key],{shouldValidate:!0})},options:b.c,placeholder:"Select a topic",required:!0,selectedKey:Z,styles:{root:{marginBottom:".5em"}}})},rules:{required:"Please select a topic."}}),(0,a.jsxs)(u.o,Object.assign({onLinkClick:function(e){"Preview"===(null===e||void 0===e?void 0:e.props.headerText)&&D(L("reply"))}},{children:[(0,a.jsxs)(g.M,Object.assign({headerText:"Write"},{children:[(0,a.jsx)(l.Qr,{control:O,defaultValue:B,name:"reply",render:function(e){var i,n=e.field,s=n.onChange,t=n.value;return(0,a.jsx)(p.n,{autoAdjustHeight:!0,errorMessage:null===(i=S.errors.reply)||void 0===i?void 0:i.message,label:"Write",multiline:!0,onChange:s,required:!0,styles:{field:{resize:"vertical"},root:{marginBottom:"1rem",selectors:{".ms-Label":{clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:"1px"}}}},value:t})},rules:{required:"Please type a message to continue."}}),(0,a.jsxs)(m.K,Object.assign({horizontal:!0,verticalAlign:"center",tokens:{childrenGap:"8"}},{children:[n&&(0,a.jsx)(v.K,Object.assign({styles:{root:{flexBasis:"15em"}},title:"Insert a quick-reply",iconProps:{iconName:"Comment"},menuProps:{items:n,onItemClick:function(e,i){var n=(null===i||void 0===i?void 0:i.data)||(null===i||void 0===i?void 0:i.text)||"";A("reply",(T||"")+n)}}},{children:"Quick replies"})),(0,a.jsx)(h.M,Object.assign({},{errorMessage:M,isSubmitting:w,submittingMessage:j}))]}))]})),(0,a.jsx)(g.M,Object.assign({headerText:"Preview"},{children:(0,a.jsx)("div",Object.assign({style:{boxSizing:"border-box",minHeight:"78px",padding:".4em 9px"}},{children:V?(0,a.jsx)(x.d,{text:B}):(0,a.jsx)("div",Object.assign({style:{padding:"0 0 2em"}},{children:"No message to preview."}))}))}))]}))]}))}}}]);
//# sourceMappingURL=404.d126695e.chunk.js.map